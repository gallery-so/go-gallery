version: 1
packages:
  - path: "db/sqlc"
    name: "sqlc"
    engine: "postgresql"
    schema: "db/migrations/"
    queries: "db/queries"
    sql_package: "pgx/v4"
    output_db_file_name: "db_gen.go"
    output_models_file_name: "models_gen.go"

# Overrides are prioritized from top to bottom, so if we need to override one of the * entries (like *.id),
# the override should come _before_ the * entry
overrides:
  # Users
  - column: "users.wallets"
    go_type: "github.com/mikeydub/go-gallery/service/persist.WalletList"

  # Galleries
  - column: "galleries.collections"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBIDList"

  # Collections
  - column: "collections.nfts"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBIDList"
  - column: "collections.layout"
    go_type: "github.com/mikeydub/go-gallery/service/persist.TokenLayout"
  - column: "collections.token_settings"
    go_type: { "type": "map[persist.DBID]persist.CollectionTokenSettings" }

  # Nfts
  - column: "nfts.contract"
    go_type: "github.com/mikeydub/go-gallery/service/persist.NFTContract"

  # Tokens
  - column: "tokens.owned_by_wallets"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBIDList"
  - column: "tokens.contract"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"

  # Contracts
  - column: "contracts.address"
    go_type: "github.com/mikeydub/go-gallery/service/persist.Address"

  # Membership
  - column: "membership.owners"
    go_type: "github.com/mikeydub/go-gallery/service/persist.TokenHolderList"
  # Wallet
  - column: "wallets.address"
    go_type: "github.com/mikeydub/go-gallery/service/persist.Address"
  - column: "wallets.wallet_type"
    go_type: "github.com/mikeydub/go-gallery/service/persist.WalletType"

  # Follows
  - column: "follows.followee"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "follows.follower"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"

  # Events
  - column: "events.actor_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "events.resource_type_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.ResourceType"
  - column: "events.user_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "events.token_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "events.collection_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "events.subject_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "events.action"
    go_type: "github.com/mikeydub/go-gallery/service/persist.Action"
  - column: "events.data"
    go_type: "github.com/mikeydub/go-gallery/service/persist.EventData"
  - column: "events.feed_window_size"
    go_type: "int"

  # Admires
  - column: "admires.actor_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "admires.feed_event_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"

  # Comments
  - column: "comments.actor_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "comments.feed_event_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "comments.reply_to"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"

  # Feed Events
  - column: "feed_events.owner_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "feed_events.action"
    go_type: "github.com/mikeydub/go-gallery/service/persist.Action"
  - column: "feed_events.event_ids"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBIDList"
  - column: "feed_events.data"
    go_type: "github.com/mikeydub/go-gallery/service/persist.FeedEventData"

  # Feed Blocklist
  - column: "feed_blocklist.user_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "feed_blocklist.action"
    go_type: "github.com/mikeydub/go-gallery/service/persist.Action"

  # Wildcards
  # Note: to override one of these wildcard entries, add a more specific entry (like some_table.id) above
  - column: "*.id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "*.owner_user_id"
    go_type: "github.com/mikeydub/go-gallery/service/persist.DBID"
  - column: "*.owner_address"
    go_type: "github.com/mikeydub/go-gallery/service/persist.Address"
  - column: "*.creator_address"
    go_type: "github.com/mikeydub/go-gallery/service/persist.Address"
